ライセンスについて

このパッケージにあるものはt5lzmaを除いて、すべてKL-01です。
t5lzmaのソースは、tk5lgpl1にあります。

dtk5s0cは一から僕が書いたので、完全にKL-01になりました。

t5lzma_p.txtについては、これをLZMA-SDKに対するパッチだと誤解する非常に迷惑な問
い合わせがあったのでバンドルをやめました（もともとライセンス防衛のためのもので
ありそれ以外の用途のものではないので）。

---

bim2bin4は、tek5を生成するときに限って、t5lzmaが必要です。bim2bin.exeと同じ場
所にt5lzma.exeをおいておいてください。tek5を生成しないのなら、t5lzmaは不要です
。展開だけならt5lzmaはいりません。

bim2bin4は、基本的にOSASK ver.4.7と組み合わせて利用することを前提にしており、
デフォルトで生成したアプリケーションやデフォルトで圧縮したデータは、OSASK ver.
4.5以前では利用できません。OSASK ver.4.5以前でも利用したい場合は、-tek0 rjc:0
の2つのオプションを追加してください。tek5のときにeprm:z0を指定すれば、stk5モー
ドになってOSASK ver.4.6でも使えます。

bim2bin4からrjcオプション（相対ジャンプコンバータオプション）がデフォルトで有効
になるため、OSASKアプリに限り、同じ圧縮形式であっても以前よりコンパクトになる傾
向があります。これをオフにしたい場合、圧縮時にrjc:0を指定してください。

その他、デフォルト値がいくつか変更されています。BS:のデフォルトは0になりました
。MD:のデフォルトはtek1〜tek5のときはMD:0になりました。clv:のデフォルトは4にあ
がりました。

OSASKアプリを生成する場合（bimからorgを作るときの話）、-tek5を選ぶためには、
obj2bimでスタックを大きめにとってある必要があります。-tek0〜-tek2までなら、今ま
でどおり最低4kでかまいません。-tek5を選ぶ場合、20kを最低と考えてください。
-osacmpのときは（orgからbinを作る場合）、-tek5を選んでもスタックを直さなければ
いけないということはありません。

bim2bin4の-restoreはまったくチューンされていない展開ルーチンを使っているので、
展開は遅いです。添付のtstdstk等を使うほうがずっと高速です。bim2bin4のrestore機
能はおまけだと思ってください。

---

簡単な使い方：

[圧縮]

prompt>bim2bin -osacmp -tek1 in:data.bin out:data.tk

prompt>bim2bin -osacmp -tek2 in:data.bin out:data.tk

prompt>bim2bin -osacmp -tek5 in:data.bin out:data.tk

tek1とtek2では、いずれもデフォルトではstk互換形式になります。tek5ではデフォルト
は、stk非互換形式です。8MBを超えるファイルはin:に指定しないでください。

[展開]

prompt>bim2bin -restore in:data.tk out:data.bin

[アプリ生成]

prompt>bim2bin in:helloc4.bim out:helloc4.org malloc:1k mmarea:0 -tek1

prompt>bim2bin in:helloc4.bim out:helloc4.org malloc:1k mmarea:0 -tek5

[-tek5で使える追加オプション]

  eprm:z0 -- stk5互換モード（圧縮・展開が速いが圧縮率は良くない）
  eprm:z1 -- tek5コンパクトモード（小規模・中規模のものはこれが一番効く）
  eprm:z2 -- tek5ノーマルモード。デフォルト。
  eprm:@  -- tek5オートモード。z0〜z2のどれにするかを解析して自動決定する。
             しかしそれ相応の時間が掛かるので、気軽には使えない。
             512/1024コンテストなどのときには重宝する。

---

推奨：

OSASKでは書き換えアクセスをしないファイルについては、圧縮しておくことが推奨され
ます。もちろん、-osacmpしたら結果的に大きくなってしまうとか、せいぜい1割しか小
さくならないというような場合は、圧縮しておかなくてもいいと思います。

圧縮するとなると、どの形式を使うかで迷うと思います。そんなときは、まず、tek5で
圧縮してみましょう。そして圧縮の結果が100KBを超えるようなら、tek2にすることも検
討しましょう。

これはtek5の展開に少々時間がかかるためで（といってもtek0程度ですが）、小さなフ
ァイルでは展開時間が気になることはまずないですが、大きなファイルでは気になる人
がいるかもしれないからです。・・・でも、大きなファイルこそ高圧縮にしたい場合も
ありますので、そういう時はtek5でいいでしょう。また、100KBというのは一つの目安で
あって、人によって20KBだったり500KBだったりしていいと思います。

---

おまけ：

最後まで読んでくれたあなたに、512バイトキャンペーン・1024バイトキャンペーン時に
有利になるテクニックを教えてあげます。他の人には内緒ですよ、なんていうせこいこ
とは言いませんので、知らない人がいたら教えてあげてください。

１．
ASKAやNASMで作ったOSASKアプリをosacmpするときには、rjc:0のほうが圧縮率がいい場
合があります。やり比べてみると